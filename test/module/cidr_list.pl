#============================================================================================================
#
#	携帯IPのCIDRチェック
#
#	by EXぜろちゃんねる
#	http://zerochplus.sourceforge.jp/
#
#============================================================================================================

package ZP_CIDR;

use strict;
use utf8;
use open IO => ':encoding(cp932)';
#use warnings;

our $cidr = ();

#------------------------------------------------------------------------------------------------------------
#
#	CIDRリスト
#	-------------------------------------------------------------------------------------
#	ただ我武者羅に資料を集めて配列化しただけ
#	どう使うかはあなた次第だ
#
#------------------------------------------------------------------------------------------------------------
{
	
	# NTT docomo : iモード [ docomo.ne.jp ]
	$cidr->{'docomo'} = [
		# http://www.nttdocomo.co.jp/service/developer/make/content/ip/
		# 2023/11/11に確認して増えていたり減っていたりしていたものを修正
		'210.153.84.0/24',		'210.136.161.0/24',		'210.153.86.0/24',		'124.146.174.0/24',
		'124.146.175.0/24',		'202.229.176.0/24',		'202.229.177.0/24',		'202.229.178.0/24',
		'203.138.204.160/27',
	];
	
	# NTT docomo : iモードフルブラウザ
	$cidr->{'docomo_pc'} = [
		# http://www.nttdocomo.co.jp/service/developer/make/content/ip/
		# 2023/11/11に確認して増えていたり減っていたりしていたものを修正
		'210.153.87.0/24',		'203.138.204.160/27',
	];
	
	# NTT docomo : spモード(スマートフォン)
	$cidr->{'docomo_smart'} = [
		# http://www.nttdocomo.co.jp/service/developer/smart_phone/technical_info/etc/
		# 2013/10/12確認
		'1.66.96.0/21',			'1.66.104.0/23',		'1.72.0.0/21',			'1.72.8.0/23',
		'1.72.10.0/24',			'1.75.0.0/21',			'1.75.8.0/22',			'1.75.12.0/23',
		'1.75.14.0/24',			'1.75.16.0/20',			'1.75.152.0/21',		'1.75.224.0/19',
		'1.78.0.0/19',			'1.78.32.0/21',			'1.78.40.0/22',			'1.78.64.0/18',
		'1.79.6.0/23',			'1.79.8.0/21',			'1.79.16.0/21',			'1.79.24.0/22',
		'1.79.28.0/23',			'1.79.30.0/24',			'1.79.32.0/21',			'1.79.66.0/23',
		'1.79.68.0/22',			'1.79.72.0/21',			'1.79.80.0/20',			'1.79.96.0/21',
		'49.96.0.0/18',			'49.96.216.0/21',		'49.96.224.0/19',		'49.97.0.0/18',
		'49.97.64.0/20',		'49.97.88.0/22',		'49.97.92.0/22',		'49.97.96.0/19',
		'49.98.7.0/24',			'49.98.8.0/21',			'49.98.16.0/24',		'49.98.32.0/19',
		'49.98.64.0/18',		'49.98.128.0/17',		'110.163.6.0/23',		'110.163.8.0/22',
		'110.163.12.0/23',		'110.163.216.0/21',		'110.163.224.0/22',		'183.74.0.0/21',
		'183.74.8.0/23',		'183.75.128.0/18',
		# 2013年11月 削除予定
		'1.75.160.0/20',		'1.75.176.0/22',		'1.75.180.0/23',		'183.74.224.0/20',
		'183.74.240.0/21',		'183.74.248.0/22',
		# 2013年11月 追加予定
		'1.75.196.0/22',		'1.75.208.0/21',		'1.79.176.0/21',
		# 2013年11月 一部削除し変更予定 ※
		'183.74.192.0/19',
		# 2013年11月 追加予定 ※前行より変更
		'183.74.192.0/20',
	];
	
	# SoftBank : 3G [ softbank.ne.jp ]
	$cidr->{'vodafone'} = 
	$cidr->{'softbank'} = [
		# http://creation.mb.softbank.jp/web/web_ip.html
		# 2012/07/25更新 2013/10/12確認
		'123.108.237.112/28',	'123.108.239.224/28',	'202.253.96.144/28',	'202.253.99.144/28',
		'210.228.189.188/30',
	];
	
	# Softbank : 3G PCサイトブラウザ
	$cidr->{'vodafone_pc'} = 
	$cidr->{'softbank_pc'} = [
		# http://creation.mb.softbank.jp/web/web_ip.html
		# 2012/07/25更新 2013/10/12確認
		'123.108.237.128/28',	'123.108.239.240/28',	'202.253.96.160/28',	'202.253.99.160/28',
		'210.228.189.196/30',
	];
	
	# Softbank : スマートフォン ※3G PCサイトブラウザを含む
	$cidr->{'softbank_smart'} = [
		# https://www.support.softbankmobile.co.jp/partner/home_tech1/
		# 2013/08/09更新 2013/10/12確認
		'123.108.237.128/28',	'123.108.239.240/28',	'126.163.0.0/16',		'126.192.0.0/16',
		'126.193.0.0/16',		'126.194.208.0/22',		'126.204.0.0/16',		'202.253.96.160/28',
		'202.253.99.160/28',	'210.228.189.196/30',
		# Xシリーズ 一部アプリ
		# https://www.support.softbankmobile.co.jp/partner_st/home_tech1/X_series/index.cfm
		# 2013/05/31更新 2013/10/12確認
		'126.243.0.0/16',
	];
	
	# Softbank : iPhone/iPad 3G
	$cidr->{'softbank_iphone'} = [
		# 非公式情報 (基本放置でいきましょう 2012.06 じ)
		# panda-world.ne.jp
		# http://d.hatena.ne.jp/y-kawaz/20110427/1303870851
		# https://twitter.com/panda_watcher
		'126.95.0.0/16',		'126.140.0.0/14',		'126.144.0.0/12',		'126.160.0.0/11',
		'126.195.0.0/16',		'126.196.0.0/14',		'126.200.0.0/13',		'126.208.0.0/12',
		'126.224.0.0/11',
		# http://d.hatena.ne.jp/unstablelife/20101228/1293538861
		# http://durianjp.com/mt/2011/01/iphone-ip.html
		#'126.160.0.0/11',		'126.192.0.0/10',
	];
	
	# KDDI au : EZweb [ ezweb.ne.jp ]
	$cidr->{'ezweb'} = [
		# http://www.au.kddi.com/ezfactory/tec/spec/ezsava_ip.html
		# 2013/09/19更新 2013/10/12確認
		'210.230.128.224/28',	'219.108.158.0/27',		'219.125.146.0/28',		'61.117.2.32/29',
		'61.117.2.40/29',		'219.108.158.40/29',	'111.86.142.0/26',		'111.86.143.192/27',
		'111.86.141.64/26',		'111.86.141.128/26',	'111.86.141.192/26',	'111.86.142.160/27',
		'111.86.143.224/27',	'111.86.147.0/27',		'111.86.142.128/27',	'111.86.143.32/27',
		'111.86.142.192/27',	'111.86.142.224/27',	'111.86.143.0/27',		'111.86.147.128/27',
		'111.86.147.32/27',		'111.86.147.64/27',		'111.86.147.96/27',		'111.86.147.160/27',
		'111.86.147.192/27',	'111.86.147.224/27',	
		# 2011年秋冬モデル以降の一部機種のEZサーバ
		'111.107.116.64/26',	'106.162.214.160/29',	'111.107.116.192/28',
	];
	
	# KDDI au : EZweb PCサイトビューア
	$cidr->{'ezweb_pc'} = [
		# http://www.au.kddi.com/ezfactory/tec/spec/ezsava_ip.html
		# 2012/09/13更新 2013/10/12確認
		'222.15.68.192/26',		'59.135.39.128/27',		'118.152.214.160/27',	'118.152.214.128/27',
		'222.1.136.96/27',		'222.1.136.64/27',		'59.128.128.0/20',		'111.86.140.40/30',
		'111.86.140.44/30',		'111.86.140.48/30',		'111.86.140.52/30',		'111.86.140.56/30',
		'111.86.140.60/30',		'111.87.241.144/28',
	];
	
	# KDDI au : IS NET/LTE NET(スマートフォン)
	$cidr->{'ezweb_smart'} = [
		# http://www.au.kddi.com/developer/android/kaihatsu/network/
		# 2013/10更新 2013/10/12確認
		'106.128.0.0/13',		'111.86.140.128/27',	'182.248.112.128/26',	'182.249.0.0/16',
		'182.250.0.0/15',
		# 注) 182.249.0.0/16は以下のアドレスを除く
		#  182.249.246.1～182.249.246.3
		#  182.249.246.11～182.249.246.13
		#  182.249.246.21～182.249.246.23
		#  182.249.246.31～182.249.246.33
		#  182.249.246.97～182.249.246.126
	];
	
	# イー・モバイル [ emobile.ad.jp ]
	$cidr->{'emobile'} = [
		# http://developer.emnet.ne.jp/ipaddress.html
		# 2008/02/26更新 2013/10/12確認
		'117.55.1.224/27'
	];
	
	# WILLCOM [ prin.ne.jp ]
	$cidr->{'willcom'} = [
		# http://www.willcom-inc.com/ja/service/contents_service/create/center_info/
		# 2013/09/26更新 2013/10/12確認
		'61.198.129.0/24',		'61.198.130.0/24',		'61.198.132.0/24',		'61.198.133.0/24',
		'61.198.134.0/24',		'61.198.135.0/24',		'61.198.136.0/24',		'61.198.137.0/24',
		'61.198.139.0/29',		'61.198.139.128/27',	'61.198.139.160/28',	'61.198.142.0/24',
		'61.198.160.0/24',		'61.198.161.0/24',		'61.198.162.0/24',		'61.198.163.0/24',
		'61.198.164.0/24',		'61.198.168.0/24',		'61.198.169.0/24',		'61.198.170.0/24',
		'61.198.171.0/24',		'61.198.172.0/24',		'61.198.173.0/24',		'61.198.174.0/24',
		'61.198.175.0/24',		'61.198.248.0/24',		'61.198.249.0/24',		'61.198.250.0/24',
		'61.198.251.0/24',		'61.198.252.0/24',		'61.198.253.0/24',		'61.198.255.0/24',
		'61.204.0.0/24',		'61.204.2.0/24',		'61.204.3.128/25',		'61.204.4.0/24',
		'61.204.5.0/24',		'61.204.6.128/25',		'61.204.7.0/25',		'61.204.92.0/24',
		'61.204.93.0/24',		'61.204.94.0/24',		'61.204.95.0/24',		'114.20.49.0/24',
		'114.20.50.0/24',		'114.20.51.0/24',		'114.20.52.0/24',		'114.20.53.0/24',
		'114.20.54.0/24',		'114.20.55.0/24',		'114.20.56.0/24',		'114.20.57.0/24',
		'114.20.58.0/24',		'114.20.59.0/24',		'114.20.60.0/24',		'114.20.61.0/24',
		'114.20.62.0/24',		'114.20.63.0/24',		'114.20.64.0/24',		'114.20.65.0/24',
		'114.20.66.0/24',		'114.20.67.0/24',		'114.20.128.0/17',		'114.21.128.0/24',
		'114.21.129.0/24',		'114.21.130.0/24',		'114.21.131.0/24',		'114.21.132.0/24',
		'114.21.133.0/24',		'114.21.134.0/24',		'114.21.135.0/24',		'114.21.136.0/24',
		'114.21.137.0/24',		'114.21.138.0/24',		'114.21.139.0/24',		'114.21.140.0/24',
		'114.21.141.0/24',		'114.21.142.0/24',		'114.21.143.0/24',		'114.21.144.0/24',
		'114.21.145.0/24',		'114.21.146.0/24',		'114.21.147.0/24',		'114.21.148.0/24',
		'114.21.149.0/24',		'125.28.0.0/24',		'125.28.1.0/24',		'125.28.2.0/24',
		'125.28.3.0/24',		'125.28.6.0/24',		'125.28.7.0/24',		'125.28.8.0/24',
		'125.28.11.0/24',		'125.28.12.0/24',		'125.28.13.0/24',		'125.28.14.0/24',
		'125.28.15.0/24',		'125.28.16.0/24',		'125.28.17.0/24',		'210.168.246.0/24',
		'210.168.247.0/24',		'210.169.92.0/24',		'210.169.93.0/24',		'210.169.95.0/24',
		'210.169.96.0/24',		'210.169.97.0/24',		'210.169.98.0/24',		'210.169.99.0/24',
		'210.255.190.0/24',		'211.126.192.128/25',	'211.18.232.0/24',		'211.18.233.0/24',
		'211.18.234.0/24',		'211.18.235.0/24',		'211.18.236.0/24',		'211.18.237.0/24',
		'211.18.238.0/24',		'211.18.239.0/24',		'219.108.2.0/24',		'219.108.3.0/24',
		'219.108.4.0/24',		'219.108.5.0/24',		'219.108.6.0/24',		'219.108.7.0/24',
		'219.108.10.0/24',		'219.108.11.0/24',		'219.108.12.0/24',		'219.108.13.0/24',
		'219.108.14.0/24',		'219.108.15.0/24',		'221.109.128.0/18',		'221.119.0.0/24',
		'221.119.1.0/24',		'221.119.2.0/24',		'221.119.3.0/24',		'221.119.4.0/24',
		'221.119.5.0/24',		'221.119.6.0/24',		'221.119.7.0/24',		'221.119.8.0/24',
		'221.119.9.0/24',
	];
	
	# ibisブラウザ
	$cidr->{'ibis'} = [
		# http://ibis.ne.jp/support/browserIP.jsp
		# 2013/10/12確認
		'54.248.5.162/32',		'54.248.145.37/32',		'54.248.147.159/32',	'54.248.148.218/32',
		'54.248.150.59/32',		'54.248.153.81/32',		'54.248.160.163/32',	'54.248.164.51/32',
		'54.248.165.159/32',	'54.248.173.87/32',		'54.248.176.184/32',	'54.248.178.251/32',
		'54.248.181.37/32',		'54.248.184.172/32',	'54.248.187.26/32',		'54.248.226.234/32',
		'54.248.229.21/32',		'54.248.233.80/32',		'175.41.198.11/32',		'176.34.14.9/32',
	];
	
	# jigブラウザ
	$cidr->{'jig'} = [
		# http://br.jig.jp/pc/ip_br.html
		# 2013/07/31更新 2013/10/12確認
		'112.78.114.208/32',	'112.78.207.6/31',		'112.78.207.8/29',		'112.78.207.16/29',
		'112.78.207.24/31',		'112.78.215.70/31',		'112.78.215.72/29',		'112.78.215.80/29',
		'112.78.215.88/31',		'112.78.215.166/31',	'112.78.215.168/29',	'112.78.215.176/29',
		'112.78.215.184/31',	'112.78.215.230/31',	'112.78.215.232/29',	'112.78.215.240/29',
		'112.78.215.248/31',	'182.48.5.230/31',		'182.48.5.232/29',		'202.181.98.160/32',
		'202.181.98.179/32',	'202.181.98.196/32',	'210.188.205.81/32',	'210.188.205.83/32',
		'219.94.177.6/31',		'219.94.177.8/29',		'219.94.177.16/29',		'219.94.177.24/31',
		'219.94.182.230/31',	'219.94.182.232/29',	'219.94.182.240/29',	'219.94.182.248/31',
		'219.94.183.102/31',	'219.94.183.104/29',	'219.94.183.112/29',	'219.94.183.120/31',
		'219.94.184.70/31',		'219.94.184.72/29',
	];
	
	$cidr->{'iphone'} = [(
		@{$cidr->{'softbank_iphone'}},
	)];
	# uqwimax.jp
	
	# p2
	$cidr->{'p2'} = [
		# cw43.razil.jp
		'210.135.98.43',
		# p202.razil.jp
		'210.135.100.132',
	];

	#cloudflare
	$cidr->{'cf_v4'} = [
    '103.21.244.0/22',	'103.22.200.0/22',	'103.31.4.0/22',	'104.16.0.0/13',	'104.24.0.0/14',	
    '108.162.192.0/18',	'131.0.72.0/22',	'141.101.64.0/18',	'162.158.0.0/15',	'172.64.0.0/13',	
    '173.245.48.0/20',	'188.114.96.0/20',	'190.93.240.0/20',	'197.234.240.0/22',	'198.41.128.0/17',
	];
	$cidr->{'cf_v6'} = [
    '2400:cb00::/32', '2606:4700::/32', '2803:f800::/32', '2405:b500::/32', '2405:8100::/32', 
    '2a06:98c0::/29', '2c0f:f248::/32',
	];

	# akamai
	$cidr->{'ak_v4'} = [
	'2.16.0.0/13',	'23.0.0.0/12',	'23.192.0.0/11',	'23.32.0.0/11',	'95.100.0.0/15',
	'184.24.0.0/13',
	];
	$cidr->{'ak_v6'} = [
    '2a02:26f0::/32 ',	'2600:1400::/24',	'2405:9600::/32',
	];

	# fastly
	$cidr->{'fs_v4'} = [
	"23.235.32.0/20",	"43.249.72.0/22",	"103.244.50.0/24",	"103.245.222.0/23",	"103.245.224.0/24",
	"104.156.80.0/20",	"140.248.64.0/18",	"140.248.128.0/17",	"146.75.0.0/17",	"151.101.0.0/16",
	"157.52.64.0/18",	"167.82.0.0/17",	"167.82.128.0/20",	"167.82.160.0/20",	"167.82.224.0/20",
	"172.111.64.0/18",	"185.31.16.0/22",	"199.27.72.0/21",	"199.232.0.0/16"
	];
	$cidr->{'fs_v6'} = [
    "2a04:4e40::/32",	"2a04:4e42::/32",
	];

	# cloudfront
	$cidr->{'aws_v4'} = [
	"120.52.22.96/27", "205.251.249.0/24", "180.163.57.128/26", "204.246.168.0/22", "111.13.171.128/26",
	"18.160.0.0/15", "205.251.252.0/23", "54.192.0.0/16", "204.246.173.0/24", "54.230.200.0/21",
	"120.253.240.192/26", "116.129.226.128/26", "130.176.0.0/17", "3.173.192.0/18", "108.156.0.0/14",
	"99.86.0.0/16", "13.32.0.0/15", "120.253.245.128/26", "13.224.0.0/14", "70.132.0.0/18",
	"15.158.0.0/16", "111.13.171.192/26", "13.249.0.0/16", "18.238.0.0/15", "18.244.0.0/15", 
	"205.251.208.0/20", "3.165.0.0/16", "3.168.0.0/14", "65.9.128.0/18", "130.176.128.0/18",
	"58.254.138.0/25", "205.251.206.0/23", "54.230.208.0/20", "3.160.0.0/14", "116.129.226.0/25",
	"52.222.128.0/17", "18.164.0.0/15", "111.13.185.32/27", "64.252.128.0/18", "205.251.254.0/24",
	"3.166.0.0/15", "54.230.224.0/19", "71.152.0.0/17", "216.137.32.0/19", "204.246.172.0/24",
	"205.251.202.0/23", "18.172.0.0/15", "120.52.39.128/27", "118.193.97.64/26", "3.164.64.0/18",
	"18.154.0.0/15", "3.173.0.0/17", "54.240.128.0/18", "205.251.250.0/23", "180.163.57.0/25", 
	"52.46.0.0/18", "3.174.0.0/15", "52.82.128.0/19", "54.230.0.0/17", "54.230.128.0/18",
	"54.239.128.0/18", "130.176.224.0/20", "36.103.232.128/26", "52.84.0.0/15", "143.204.0.0/16", 
	"144.220.0.0/16", "120.52.153.192/26", "119.147.182.0/25", "120.232.236.0/25", "111.13.185.64/27", 
	"3.164.0.0/18", "3.172.64.0/18", "54.182.0.0/16", "58.254.138.128/26", "120.253.245.192/27", 
	"54.239.192.0/19", "18.68.0.0/16", "18.64.0.0/14", "120.52.12.64/26", "99.84.0.0/16", 
	"205.251.204.0/23", "130.176.192.0/19", "52.124.128.0/17", "204.246.164.0/22", "13.35.0.0/16", 
	"204.246.174.0/23", "3.164.128.0/17", "3.172.0.0/18", "36.103.232.0/25", "119.147.182.128/26", 
	"118.193.97.128/25", "120.232.236.128/26", "204.246.176.0/20", "65.8.0.0/16", "65.9.0.0/17", 
	"108.138.0.0/15", "120.253.241.160/27", "3.173.128.0/18", "64.252.64.0/18","13.113.196.64/26", 
	"13.113.203.0/24", "52.199.127.192/26", "57.182.253.0/24", "57.183.42.0/25", "13.124.199.0/24", 
	"3.35.130.128/25", "52.78.247.128/26", "13.203.133.0/26", "13.233.177.192/26", "15.207.13.128/25", 
	"15.207.213.128/25", "52.66.194.128/26", "13.228.69.0/24", "47.129.82.0/24", "47.129.83.0/24", 
	"47.129.84.0/24", "52.220.191.0/26", "13.210.67.128/26", "13.54.63.128/26", "3.107.43.128/25", 
	"3.107.44.0/25", "3.107.44.128/25", "43.218.56.128/26", "43.218.56.192/26", "43.218.56.64/26", 
	"43.218.71.0/26", "99.79.169.0/24", "18.192.142.0/23", "18.199.68.0/22", "18.199.72.0/22", 
	"18.199.76.0/22", "35.158.136.0/24", "52.57.254.0/24", "18.200.212.0/23", "52.212.248.0/26", 
	"13.134.24.0/23", "18.175.65.0/24", "18.175.66.0/24", "18.175.67.0/24", "3.10.17.128/25", 
	"3.11.53.0/24", "52.56.127.0/25", "15.188.184.0/24", "52.47.139.0/24", "3.29.40.128/26", 
	"3.29.40.192/26", "3.29.40.64/26", "3.29.57.0/26", "18.229.220.192/26", "18.230.229.0/24", 
	"18.230.230.0/25", "54.233.255.128/26", "56.125.46.0/24", "56.125.47.0/32", "56.125.48.0/24", 
	"3.231.2.0/25", "3.234.232.224/27", "3.236.169.192/26", "3.236.48.0/23", "34.195.252.0/24", 
	"34.226.14.0/24", "44.220.194.0/23", "44.220.196.0/23", "44.220.198.0/23", "44.220.200.0/23", 
	"44.220.202.0/23", "44.222.66.0/24", "13.59.250.0/26", "18.216.170.128/25", "3.128.93.0/24", 
	"3.134.215.0/24", "3.146.232.0/22", "3.147.164.0/22", "3.147.244.0/22", "52.15.127.128/26", 
	"3.101.158.0/23", "52.52.191.128/26", "34.216.51.0/25", "34.223.12.224/27", "34.223.80.192/26", 
	"35.162.63.192/26", "35.167.191.128/26", "35.93.168.0/23", "35.93.170.0/23", "35.93.172.0/23", 
	"44.227.178.0/24", "44.234.108.128/25", "44.234.90.252/30",
	];


}

1;
